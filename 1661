SELECT p1.machine_id,
ROUND(AVG(p2.timestamp-p1.timestamp),3) AS processing_time
FROM Activity p1
JOIN Activity p2
ON p1.machine_id=p2.machine_id
AND p1.process_id=p2.process_id
AND p1.activity_type='start'
AND p2.activity_type='end'
GROUP BY p1.machine_id;
